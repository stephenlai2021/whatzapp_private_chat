import{Q as pe,$ as he,a0 as Nt,a1 as Ut,a2 as De,a3 as Ve,V as He,C as ye,S as Ee,i as Ie,s as ze,l as Z,f as M,x as ie,K as re,d as f,a4 as je,a5 as Ke,a6 as At,a7 as we,a8 as Mt,a9 as Fe,e as h,k as O,t as ee,c as _,a as y,n as P,g as te,aa as le,ab as j,b as o,F as H,G as u,M as $,h as se,ac as Je,ad as Ot,O as Ne,ae as Qe,af as me,ag as Pt,ah as Ct,ai as Xe,aj as oe,ak as Ye,al as Ze,r as Ue,u as ce,w as Ae,am as $e,an as xe,A as et,ao as St,ap as Lt,T as tt,R as Rt,j as Me,m as Oe,L as lt,o as Pe,v as Ce,W as Tt}from"../chunks/vendor-055e1022.js";import{a as ne,d as ue,s as _e,g as Gt}from"../chunks/navigation-67eee336.js";import"../chunks/singletons-12a22614.js";const Bt=async r=>{let e=null;const t=pe(ue,"whatzapp_users",ne.currentUser.uid),l=he(_e,`whatzapp/${r.name}`);Nt(t).then(s=>{s.exists()&&(e=s.data(),console.log("user data: ",e),Ut(he(_e,e.avatarPath)).then(()=>{console.log("file deleted successfully")}).catch(a=>{console.log(a.message)}))});try{const s=await De(l,r),a=await Ve(he(_e,s.ref.fullPath));console.log("file name: ",s.ref.fullPath),console.log("file url: ",a),await He(t,{avatar:a,avatarPath:s.ref.fullPath})}catch(s){console.log(s.message)}},Se=ye({}),st=ye([]),at=ye(null),Wt=ye(JSON.parse(localStorage.getItem("user")));Wt.subscribe(r=>localStorage.setItem("user",JSON.stringify(r)));function it(r,e,t){const l=r.slice();return l[6]=e[t],l}function qt(r){let e,t,l,s,a,i,c,n,g,p,b,m,v,E,k,d=r[6].name+"",w,I,T,W;return{c(){e=h("div"),t=h("div"),l=h("ion-icon"),s=O(),a=h("div"),i=h("div"),c=h("img"),g=O(),p=h("label"),b=h("ion-icon"),m=O(),v=h("input"),E=O(),k=h("p"),w=ee(d),this.h()},l(N){e=_(N,"DIV",{class:!0});var U=y(e);t=_(U,"DIV",{class:!0,style:!0});var C=y(t);l=_(C,"ION-ICON",{name:!0,style:!0,class:!0}),y(l).forEach(f),C.forEach(f),s=P(U),a=_(U,"DIV",{class:!0});var A=y(a);i=_(A,"DIV",{class:!0});var z=y(i);c=_(z,"IMG",{src:!0,alt:!0,class:!0}),g=P(z),p=_(z,"LABEL",{class:!0});var D=y(p);b=_(D,"ION-ICON",{class:!0,name:!0}),y(b).forEach(f),m=P(D),v=_(D,"INPUT",{type:!0,class:!0}),D.forEach(f),z.forEach(f),A.forEach(f),E=P(U),k=_(U,"P",{class:!0});var V=y(k);w=te(V,d),V.forEach(f),U.forEach(f),this.h()},h(){le(l,"name","close-outline"),j(l,"font-size","1.5rem"),le(l,"class","svelte-cegaxt"),o(t,"class","close-icon svelte-cegaxt"),j(t,"text-align","right"),j(t,"padding","5px"),H(c.src,n=r[6].avatar)||o(c,"src",n),o(c,"alt","user avatar"),o(c,"class","svelte-cegaxt"),le(b,"class","icon-camera svelte-cegaxt"),le(b,"name","camera-outline"),o(v,"type","file"),o(v,"class","svelte-cegaxt"),o(p,"class","svelte-cegaxt"),o(i,"class","avatar-box svelte-cegaxt"),o(a,"class","avatar-container svelte-cegaxt"),o(k,"class","center svelte-cegaxt"),o(e,"class","profile-modal svelte-cegaxt")},m(N,U){M(N,e,U),u(e,t),u(t,l),u(e,s),u(e,a),u(a,i),u(i,c),u(i,g),u(i,p),u(p,b),u(p,m),u(p,v),u(e,E),u(e,k),u(k,w),T||(W=[$(l,"click",r[12]),$(v,"change",r[7])],T=!0)},p(N,U){U&64&&!H(c.src,n=N[6].avatar)&&o(c,"src",n),U&64&&d!==(d=N[6].name+"")&&se(w,d)},i(N){I||Je(()=>{I=Ot(e,Ct,{x:-30}),I.start()})},o:re,d(N){N&&f(e),T=!1,Ne(W)}}}function Ht(r){let e,t,l,s,a,i,c,n,g,p,b,m,v,E,k,d,w,I,T;function W(z,D){return z[3]?Kt:Ft}let N=W(r),U=N(r),C=r[6]&&rt(r),A=r[0]&&ct(r);return{c(){e=h("div"),t=h("div"),l=h("div"),U.c(),s=O(),a=h("input"),i=O(),c=h("ul"),n=h("li"),g=h("ion-icon"),p=O(),C&&C.c(),b=O(),m=h("div"),v=h("div"),E=h("input"),k=O(),d=h("ion-icon"),w=O(),A&&A.c(),this.h()},l(z){e=_(z,"DIV",{class:!0});var D=y(e);t=_(D,"DIV",{class:!0});var V=y(t);l=_(V,"DIV",{class:!0,style:!0});var G=y(l);U.l(G),s=P(G),a=_(G,"INPUT",{type:!0,style:!0,class:!0}),G.forEach(f),i=P(V),c=_(V,"UL",{class:!0});var L=y(c);n=_(L,"LI",{class:!0});var S=y(n);g=_(S,"ION-ICON",{name:!0,class:!0}),y(g).forEach(f),S.forEach(f),L.forEach(f),p=P(V),C&&C.l(V),V.forEach(f),b=P(D),m=_(D,"DIV",{class:!0});var B=y(m);v=_(B,"DIV",{class:!0});var q=y(v);E=_(q,"INPUT",{type:!0,placeholder:!0,class:!0}),k=P(q),d=_(q,"ION-ICON",{name:!0,class:!0}),y(d).forEach(f),q.forEach(f),B.forEach(f),w=P(D),A&&A.l(D),D.forEach(f),this.h()},h(){o(a,"type","file"),j(a,"width","0"),j(a,"height","0"),j(a,"opacity","0"),j(a,"cursor","pointer"),o(a,"class","svelte-cegaxt"),o(l,"class","userimg svelte-cegaxt"),j(l,"cursor","pointer"),le(g,"name","person-outline"),le(g,"class","svelte-cegaxt"),o(n,"class","svelte-cegaxt"),o(c,"class","nav_icons svelte-cegaxt"),o(t,"class","header svelte-cegaxt"),o(E,"type","text"),o(E,"placeholder","Search User"),o(E,"class","svelte-cegaxt"),le(d,"name","search-outline"),le(d,"class","svelte-cegaxt"),o(v,"class","svelte-cegaxt"),o(m,"class","search_chat svelte-cegaxt"),o(e,"class","leftSide svelte-cegaxt")},m(z,D){M(z,e,D),u(e,t),u(t,l),U.m(l,null),u(l,s),u(l,a),u(t,i),u(t,c),u(c,n),u(n,g),u(t,p),C&&C.m(t,null),u(e,b),u(e,m),u(m,v),u(v,E),u(v,k),u(v,d),u(e,w),A&&A.m(e,null),r[11](e),I||(T=[$(a,"change",r[7]),$(n,"click",r[8])],I=!0)},p(z,D){N===(N=W(z))&&U?U.p(z,D):(U.d(1),U=N(z),U&&(U.c(),U.m(l,s))),z[6]?C?C.p(z,D):(C=rt(z),C.c(),C.m(t,null)):C&&(C.d(1),C=null),z[0]?A?A.p(z,D):(A=ct(z),A.c(),A.m(e,null)):A&&(A.d(1),A=null)},i:re,o:re,d(z){z&&f(e),U.d(),C&&C.d(),A&&A.d(),r[11](null),I=!1,Ne(T)}}}function Kt(r){let e,t;return{c(){e=h("img"),this.h()},l(l){e=_(l,"IMG",{src:!0,class:!0,alt:!0,style:!0}),this.h()},h(){H(e.src,t=r[6].avatar)||o(e,"src",t),o(e,"class","cover svelte-cegaxt"),o(e,"alt","user avatar"),j(e,"cursor","pointer")},m(l,s){M(l,e,s)},p(l,s){s&64&&!H(e.src,t=l[6].avatar)&&o(e,"src",t)},d(l){l&&f(e)}}}function Ft(r){let e,t;return{c(){e=h("img"),this.h()},l(l){e=_(l,"IMG",{src:!0,class:!0,alt:!0}),this.h()},h(){H(e.src,t="avatar.png")||o(e,"src",t),o(e,"class","cover svelte-cegaxt"),o(e,"alt","default user avatar")},m(l,s){M(l,e,s)},p:re,d(l){l&&f(e)}}}function rt(r){let e,t=r[6].name.match(/(?:\s|^)(\S)/g).join("")+"",l,s,a;return{c(){e=h("li"),l=ee(t),this.h()},l(i){e=_(i,"LI",{class:!0});var c=y(e);l=te(c,t),c.forEach(f),this.h()},h(){o(e,"class","user-name svelte-cegaxt")},m(i,c){M(i,e,c),u(e,l),s||(a=$(e,"click",r[8]),s=!0)},p(i,c){c&64&&t!==(t=i[6].name.match(/(?:\s|^)(\S)/g).join("")+"")&&se(l,t)},d(i){i&&f(e),s=!1,a()}}}function ct(r){let e,t=[],l=new Map,s=r[0];const a=i=>i[6].uid;for(let i=0;i<s.length;i+=1){let c=it(r,s,i),n=a(c);l.set(n,t[i]=ut(n,c))}return{c(){e=h("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=_(i,"DIV",{class:!0});var c=y(e);for(let n=0;n<t.length;n+=1)t[n].l(c);c.forEach(f),this.h()},h(){o(e,"class","chatlist svelte-cegaxt")},m(i,c){M(i,e,c);for(let n=0;n<t.length;n+=1)t[n].m(e,null)},p(i,c){c&531&&(s=i[0],t=Qe(t,c,a,1,i,s,l,e,Xe,ut,null,it))},d(i){i&&f(e);for(let c=0;c<t.length;c+=1)t[c].d()}}}function Jt(r){let e;return{c(){e=h("div"),this.h()},l(t){e=_(t,"DIV",{class:!0,style:!0}),y(e).forEach(f),this.h()},h(){o(e,"class","user-status svelte-cegaxt"),j(e,"background","lightgrey")},m(t,l){M(t,e,l)},d(t){t&&f(e)}}}function Qt(r){let e;return{c(){e=h("div"),this.h()},l(t){e=_(t,"DIV",{class:!0,style:!0}),y(e).forEach(f),this.h()},h(){o(e,"class","user-status svelte-cegaxt"),j(e,"background","lightgreen")},m(t,l){M(t,e,l)},d(t){t&&f(e)}}}function Xt(r){let e,t=oe(r[6].createdAt.toDate())+"",l;return{c(){e=h("p"),l=ee(t),this.h()},l(s){e=_(s,"P",{class:!0});var a=y(e);l=te(a,t),a.forEach(f),this.h()},h(){o(e,"class","time svelte-cegaxt")},m(s,a){M(s,e,a),u(e,l)},p(s,a){a&1&&t!==(t=oe(s[6].createdAt.toDate())+"")&&se(l,t)},d(s){s&&f(e)}}}function Yt(r){let e,t=oe(r[6].createdAt.toDate())+"",l;return{c(){e=h("p"),l=ee(t),this.h()},l(s){e=_(s,"P",{class:!0});var a=y(e);l=te(a,t),a.forEach(f),this.h()},h(){o(e,"class","time unread svelte-cegaxt")},m(s,a){M(s,e,a),u(e,l)},p(s,a){a&1&&t!==(t=oe(s[6].createdAt.toDate())+"")&&se(l,t)},d(s){s&&f(e)}}}function nt(r){let e,t=r[6].uid===r[1].to&&ot(r);return{c(){t&&t.c(),e=Z()},l(l){t&&t.l(l),e=Z()},m(l,s){t&&t.m(l,s),M(l,e,s)},p(l,s){l[6].uid===l[1].to?t?t.p(l,s):(t=ot(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&f(e)}}}function ot(r){let e=r[1].message+"",t;return{c(){t=ee(e)},l(l){t=te(l,e)},m(l,s){M(l,t,s)},p(l,s){s&2&&e!==(e=l[1].message+"")&&se(t,e)},d(l){l&&f(t)}}}function ut(r,e){let t,l,s,a,i,c,n,g,p,b=e[6].name+"",m,v,E,k,d,w,I;function T(D,V){return D[6].isOnline?Qt:Jt}let W=T(e),N=W(e);function U(D,V){return D[6].unread?Yt:Xt}let C=U(e),A=C(e),z=e[1]&&nt(e);return{key:r,first:null,c(){t=h("div"),l=h("div"),s=h("img"),i=O(),N.c(),c=O(),n=h("div"),g=h("div"),p=h("h4"),m=ee(b),v=O(),A.c(),E=O(),k=h("div"),z&&z.c(),d=O(),this.h()},l(D){t=_(D,"DIV",{class:!0});var V=y(t);l=_(V,"DIV",{class:!0,style:!0});var G=y(l);s=_(G,"IMG",{src:!0,class:!0,alt:!0}),i=P(G),N.l(G),G.forEach(f),c=P(V),n=_(V,"DIV",{class:!0});var L=y(n);g=_(L,"DIV",{class:!0});var S=y(g);p=_(S,"H4",{class:!0});var B=y(p);m=te(B,b),B.forEach(f),v=P(S),A.l(S),S.forEach(f),E=P(L),k=_(L,"DIV",{class:!0});var q=y(k);z&&z.l(q),q.forEach(f),L.forEach(f),d=P(V),V.forEach(f),this.h()},h(){H(s.src,a=e[6].avatar)||o(s,"src",a),o(s,"class","cover svelte-cegaxt"),o(s,"alt","user avatar"),o(l,"class","imgbx svelte-cegaxt"),j(l,"position","relative"),o(p,"class","svelte-cegaxt"),o(g,"class","listHead svelte-cegaxt"),o(k,"class","message_p svelte-cegaxt"),o(n,"class","details svelte-cegaxt"),o(t,"class","block svelte-cegaxt"),me(t,"active",e[4]===e[6].uid),this.first=t},m(D,V){M(D,t,V),u(t,l),u(l,s),u(l,i),N.m(l,null),u(t,c),u(t,n),u(n,g),u(g,p),u(p,m),u(g,v),A.m(g,null),u(n,E),u(n,k),z&&z.m(k,null),u(t,d),w||(I=$(t,"click",function(){Pt(e[9](e[6]))&&e[9](e[6]).apply(this,arguments)}),w=!0)},p(D,V){e=D,V&1&&!H(s.src,a=e[6].avatar)&&o(s,"src",a),W!==(W=T(e))&&(N.d(1),N=W(e),N&&(N.c(),N.m(l,null))),V&1&&b!==(b=e[6].name+"")&&se(m,b),C===(C=U(e))&&A?A.p(e,V):(A.d(1),A=C(e),A&&(A.c(),A.m(g,null))),e[1]?z?z.p(e,V):(z=nt(e),z.c(),z.m(k,null)):z&&(z.d(1),z=null),V&17&&me(t,"active",e[4]===e[6].uid)},d(D){D&&f(t),N.d(),A.d(),z&&z.d(),w=!1,I()}}}function Zt(r){let e;function t(a,i){return a[5]?qt:Ht}let l=t(r),s=l(r);return{c(){s.c(),e=Z()},l(a){s.l(a),e=Z()},m(a,i){s.m(a,i),M(a,e,i)},p(a,[i]){l===(l=t(a))&&s?s.p(a,i):(s.d(1),s=l(a),s&&(s.c(),ie(s,1),s.m(e.parentNode,e)))},i(a){ie(s)},o:re,d(a){s.d(a),a&&f(e)}}}function $t(r,e,t){let l=null,s=null,a=null,i=null,c=[],n=null,g=null,p=null,b=!1,m=null,v=!1,E=ne.currentUser.uid;const k=pe(ue,"whatzapp_users",ne.currentUser.uid),d=je(ue,"whatzapp_users"),w=Ke(d,At("uid","not-in",[ne.currentUser.uid])),I=["image/png","image/jpeg","image/jpg"];at.subscribe(D=>t(10,g=D));const T=D=>{let V=D.target.files[0];console.log(V),V&&I.includes(V.type)?(s=V,Bt(s)):s=null},W=()=>{t(5,v=!0)},N=async D=>{t(4,m=D.uid),l=E>m?`${E+m}`:`${m+E}`;const V=je(ue,"whatzapp_messages",l,"chat"),G=Ke(V,Mt("createdAt","asc")),L=we(G,S=>{let B=[];return S.forEach(q=>{B.unshift(q.data())}),c=B,st.set(c),()=>L()});Se.set(D),window.innerWidth<=575&&t(2,p.style.width="0px",p)},U=we(k,D=>(t(6,a=D.data()),a.avatar!==null&&t(3,b=!0),()=>U())),C=we(w,D=>{let V=[];return D.forEach(G=>{V.push(G.data())}),t(0,i=V),()=>C()});function A(D){Fe[D?"unshift":"push"](()=>{p=D,t(2,p)})}const z=()=>t(5,v=!1);return r.$$.update=()=>{if(r.$$.dirty&1024)if(!g)console.log("can't find id!");else{const D=we(pe(ue,"whatzapp_lastMsg",g),V=>(console.log("last message: ",V.data()),t(1,n=V.data()),()=>D()))}},[i,n,p,b,m,v,a,T,W,N,g,A,z]}class xt extends Ee{constructor(e){super();Ie(this,e,$t,Zt,ze,{})}}function ft(r,e,t){const l=r.slice();return l[15]=e[t],l}function dt(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function ht(r){let e,t,l,s,a,i,c,n,g,p,b,m=r[4],v=[];for(let d=0;d<m.length;d+=1)v[d]=_t(dt(r,m,d));let E=r[1],k=[];for(let d=0;d<E.length;d+=1)k[d]=mt(ft(r,E,d));return{c(){e=h("div"),t=h("header");for(let d=0;d<v.length;d+=1)v[d].c();l=O(),s=h("div"),a=h("ion-icon"),i=O(),c=h("main");for(let d=0;d<k.length;d+=1)k[d].c();this.h()},l(d){e=_(d,"DIV",{id:!0,class:!0});var w=y(e);t=_(w,"HEADER",{style:!0,class:!0});var I=y(t);for(let N=0;N<v.length;N+=1)v[N].l(I);l=P(I),s=_(I,"DIV",{class:!0,style:!0});var T=y(s);a=_(T,"ION-ICON",{name:!0}),y(a).forEach(f),T.forEach(f),I.forEach(f),i=P(w),c=_(w,"MAIN",{class:!0});var W=y(c);for(let N=0;N<k.length;N+=1)k[N].l(W);W.forEach(f),w.forEach(f),this.h()},h(){le(a,"name","close-outline"),o(s,"class","icon-close svelte-3dh70f"),j(s,"display","grid"),j(s,"justify-item","center"),j(s,"font-size","1.2rem"),j(t,"padding","0 5px"),j(t,"background","#f0f0f0"),j(t,"border-top-right-radius","10px"),o(t,"class","svelte-3dh70f"),o(c,"class","svelte-3dh70f"),o(e,"id","emoji-menu"),o(e,"class","svelte-3dh70f")},m(d,w){M(d,e,w),u(e,t);for(let I=0;I<v.length;I+=1)v[I].m(t,null);u(t,l),u(t,s),u(s,a),u(e,i),u(e,c);for(let I=0;I<k.length;I+=1)k[I].m(c,null);g=!0,p||(b=$(a,"click",r[10]),p=!0)},p(d,w){if(w&52){m=d[4];let I;for(I=0;I<m.length;I+=1){const T=dt(d,m,I);v[I]?v[I].p(T,w):(v[I]=_t(T),v[I].c(),v[I].m(t,l))}for(;I<v.length;I+=1)v[I].d(1);v.length=m.length}if(w&66){E=d[1];let I;for(I=0;I<E.length;I+=1){const T=ft(d,E,I);k[I]?k[I].p(T,w):(k[I]=mt(T),k[I].c(),k[I].m(c,null))}for(;I<k.length;I+=1)k[I].d(1);k.length=E.length}},i(d){g||(Je(()=>{n||(n=Ye(e,xe,{y:10},!0)),n.run(1)}),g=!0)},o(d){n||(n=Ye(e,xe,{y:10},!1)),n.run(0),g=!1},d(d){d&&f(e),Ze(v,d),Ze(k,d),d&&n&&n.end(),p=!1,b()}}}function _t(r){let e,t=String.fromCodePoint(r[18])+"",l,s,a,i;return{c(){e=h("div"),l=ee(t),this.h()},l(c){e=_(c,"DIV",{class:!0,"data-id":!0});var n=y(e);l=te(n,t),n.forEach(f),this.h()},h(){o(e,"class","emoji-menu-item svelte-3dh70f"),o(e,"data-id",s=r[20]),me(e,"active",r[2]===r[4][r[20]])},m(c,n){M(c,e,n),u(e,l),a||(i=$(e,"click",r[5]),a=!0)},p(c,n){n&20&&me(e,"active",c[2]===c[4][c[20]])},d(c){c&&f(e),a=!1,i()}}}function mt(r){let e,t=r[15]+"",l,s,a;return{c(){e=h("span"),l=ee(t),this.h()},l(i){e=_(i,"SPAN",{class:!0});var c=y(e);l=te(c,t),c.forEach(f),this.h()},h(){o(e,"class","emoji-grid svelte-3dh70f")},m(i,c){M(i,e,c),u(e,l),s||(a=$(e,"click",r[6]),s=!0)},p(i,c){c&2&&t!==(t=i[15]+"")&&se(l,t)},d(i){i&&f(e),s=!1,a()}}}function el(r){let e,t,l=r[0]&&ht(r);return{c(){l&&l.c(),e=Z()},l(s){l&&l.l(s),e=Z()},m(s,a){l&&l.m(s,a),M(s,e,a),t=!0},p(s,[a]){s[0]?l?(l.p(s,a),a&1&&ie(l,1)):(l=ht(s),l.c(),ie(l,1),l.m(e.parentNode,e)):l&&(Ue(),ce(l,1,1,()=>{l=null}),Ae())},i(s){t||(ie(l),t=!0)},o(s){ce(l),t=!1},d(s){l&&l.d(s),s&&f(e)}}}function tl(r,e,t){let{showEmojiMenu:l}=e;const s=$e();let a,i,c,n=[],g="",p=0,b=[128512,129313,128074,129417,128664,129504],m=[{type:"faces",minVal:128512,maxVal:128580},{type:"faces2",minVal:129296,maxVal:129327},{type:"body",minVal:128066,maxVal:128080},{type:"animals",minVal:129408,maxVal:129442},{type:"transport",minVal:128640,maxVal:128676},{type:"misc",minVal:129494,maxVal:129535}];c=b[0];const v=()=>t(1,n=[]),E=w=>{t(9,p=Number(w.target.dataset.id)),console.log("emoji id: ",p),t(2,c=b[p]),v()},k=w=>{g+=w.target.textContent,s("add-emoji",{emoji:w.target.textContent})},d=()=>s("close-menu");return r.$$set=w=>{"showEmojiMenu"in w&&t(0,l=w.showEmojiMenu)},r.$$.update=()=>{if(r.$$.dirty&512&&t(7,a=m[p].minVal),r.$$.dirty&512&&t(8,i=m[p].maxVal),r.$$.dirty&386)for(let w=a;w<=i;w++)t(1,n=[...n,String.fromCodePoint(w)])},[l,n,c,s,b,E,k,a,i,p,d]}class ll extends Ee{constructor(e){super();Ie(this,e,tl,el,ze,{showEmojiMenu:0})}}function vt(r,e,t){const l=r.slice();return l[27]=e[t],l}function sl(r){let e,t,l,s,a,i,c,n,g,p,b,m,v,E,k,d,w,I,T,W,N,U,C,A,z,D,V,G,L,S,B,q,F,fe,ve,Le,J=r[5]&&pt(r),Q=r[0]&&gt(r),X=r[1].length&&bt(r),Y=r[2]&&Vt(r),x=r[3]&&jt();return F=new ll({props:{showEmojiMenu:r[8]}}),F.$on("add-emoji",r[12]),F.$on("close-menu",r[18]),{c(){e=h("div"),t=h("div"),l=h("div"),J&&J.c(),s=O(),Q&&Q.c(),a=O(),i=h("ul"),c=h("li"),n=h("ion-icon"),g=O(),p=h("div"),b=h("div"),m=h("img"),E=O(),X&&X.c(),k=O(),d=h("div"),Y&&Y.c(),w=O(),x&&x.c(),I=O(),T=h("li"),W=h("ion-icon"),N=O(),U=h("label"),C=h("ion-icon"),A=O(),z=h("input"),D=O(),V=h("div"),G=h("input"),L=O(),S=h("li"),B=h("ion-icon"),q=O(),Me(F.$$.fragment),this.h()},l(R){e=_(R,"DIV",{class:!0});var K=y(e);t=_(K,"DIV",{class:!0});var de=y(t);l=_(de,"DIV",{style:!0});var ge=y(l);J&&J.l(ge),s=P(ge),Q&&Q.l(ge),ge.forEach(f),a=P(de),i=_(de,"UL",{class:!0});var Re=y(i);c=_(Re,"LI",{class:!0});var Te=y(c);n=_(Te,"ION-ICON",{name:!0}),y(n).forEach(f),Te.forEach(f),Re.forEach(f),de.forEach(f),g=P(K),p=_(K,"DIV",{class:!0});var be=y(p);b=_(be,"DIV",{class:!0,style:!0});var Ge=y(b);m=_(Ge,"IMG",{src:!0,alt:!0,class:!0}),Ge.forEach(f),E=P(be),X&&X.l(be),be.forEach(f),k=P(K),d=_(K,"DIV",{class:!0,style:!0});var ae=y(d);Y&&Y.l(ae),w=P(ae),x&&x.l(ae),I=P(ae),T=_(ae,"LI",{class:!0});var Be=y(T);W=_(Be,"ION-ICON",{name:!0}),y(W).forEach(f),Be.forEach(f),N=P(ae),U=_(ae,"LABEL",{class:!0});var ke=y(U);C=_(ke,"ION-ICON",{name:!0}),y(C).forEach(f),A=P(ke),z=_(ke,"INPUT",{class:!0,type:!0,style:!0}),ke.forEach(f),D=P(ae),V=_(ae,"DIV",{class:!0});var We=y(V);G=_(We,"INPUT",{type:!0,placeholder:!0,class:!0}),We.forEach(f),L=P(ae),S=_(ae,"LI",{class:!0});var qe=y(S);B=_(qe,"ION-ICON",{class:!0,name:!0}),y(B).forEach(f),qe.forEach(f),ae.forEach(f),K.forEach(f),q=P(R),Oe(F.$$.fragment,R),this.h()},h(){j(l,"display","flex"),j(l,"align-items","center"),le(n,"name","log-out-outline"),o(c,"class","svelte-z7uzbe"),o(i,"class","nav_icons svelte-z7uzbe"),o(t,"class","header svelte-z7uzbe"),H(m.src,v="whatsapp_web.jpg")||o(m,"src",v),o(m,"alt","logo pic"),o(m,"class","svelte-z7uzbe"),o(b,"class","loading svelte-z7uzbe"),j(b,"object-fit","cover"),j(b,"visibility","hidden"),j(b,"height","0"),o(p,"class","chatBox svelte-z7uzbe"),le(W,"name","happy-outline"),o(T,"class","svelte-z7uzbe"),le(C,"name","attach-outline"),o(z,"class","attach-input svelte-z7uzbe"),o(z,"type","file"),j(z,"margin","0"),j(z,"padding","0"),j(z,"box-sizing","border-box"),j(z,"width","0"),j(z,"height","0"),j(z,"opacity","0"),j(z,"cursor","pointer"),o(U,"class","icon-attach svelte-z7uzbe"),o(G,"type","text"),o(G,"placeholder","Type a message"),o(G,"class","svelte-z7uzbe"),o(V,"class","input-box svelte-z7uzbe"),le(B,"class","icon-mic svelte-z7uzbe"),le(B,"name","mic"),me(B,"micActive",r[7]),o(S,"class","svelte-z7uzbe"),o(d,"class","chatbox_input svelte-z7uzbe"),j(d,"position","relative"),o(e,"class","rightSide svelte-z7uzbe")},m(R,K){M(R,e,K),u(e,t),u(t,l),J&&J.m(l,null),u(l,s),Q&&Q.m(l,null),u(t,a),u(t,i),u(i,c),u(c,n),u(e,g),u(e,p),u(p,b),u(b,m),u(p,E),X&&X.m(p,null),u(e,k),u(e,d),Y&&Y.m(d,null),u(d,w),x&&x.m(d,null),u(d,I),u(d,T),u(T,W),u(d,N),u(d,U),u(U,C),u(U,A),u(U,z),u(d,D),u(d,V),u(V,G),lt(G,r[6]),u(d,L),u(d,S),u(S,B),r[17](e),M(R,q,K),Pe(F,R,K),fe=!0,ve||(Le=[$(c,"click",r[9]),$(W,"click",r[15]),$(z,"change",r[11]),$(G,"input",r[16]),$(G,"keypress",r[10]),$(B,"click",r[13])],ve=!0)},p(R,K){R[5]?J?J.p(R,K):(J=pt(R),J.c(),J.m(l,s)):J&&(J.d(1),J=null),R[0]?Q?Q.p(R,K):(Q=gt(R),Q.c(),Q.m(l,null)):Q&&(Q.d(1),Q=null),R[1].length?X?X.p(R,K):(X=bt(R),X.c(),X.m(p,null)):X&&(X.d(1),X=null),R[2]?Y?Y.p(R,K):(Y=Vt(R),Y.c(),Y.m(d,w)):Y&&(Y.d(1),Y=null),R[3]?x||(x=jt(),x.c(),x.m(d,I)):x&&(x.d(1),x=null),K&64&&G.value!==R[6]&&lt(G,R[6]),K&128&&me(B,"micActive",R[7]);const de={};K&256&&(de.showEmojiMenu=R[8]),F.$set(de)},i(R){fe||(ie(F.$$.fragment,R),fe=!0)},o(R){ce(F.$$.fragment,R),fe=!1},d(R){R&&f(e),J&&J.d(),Q&&Q.d(),X&&X.d(),Y&&Y.d(),x&&x.d(),r[17](null),R&&f(q),Ce(F,R),ve=!1,Ne(Le)}}}function al(r){let e,t,l;return{c(){e=h("div"),t=h("img"),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=y(e);t=_(a,"IMG",{src:!0,alt:!0,style:!0,class:!0}),a.forEach(f),this.h()},h(){H(t.src,l="whatsapp_web.jpg")||o(t,"src",l),o(t,"alt","logo pic"),j(t,"height","calc(100%)"),j(t,"width","100%"),j(t,"object-fit","cover"),o(t,"class","svelte-z7uzbe"),o(e,"class","loading svelte-z7uzbe")},m(s,a){M(s,e,a),u(e,t)},p:re,i:re,o:re,d(s){s&&f(e)}}}function pt(r){let e,t,l;return{c(){e=h("ion-icon"),this.h()},l(s){e=_(s,"ION-ICON",{name:!0,style:!0}),y(e).forEach(f),this.h()},h(){le(e,"name","arrow-back-outline"),j(e,"margin-right","10px")},m(s,a){M(s,e,a),t||(l=$(e,"click",r[14]),t=!0)},p:re,d(s){s&&f(e),t=!1,l()}}}function gt(r){let e,t,l,s,a,i,c=r[0].name+"",n;return{c(){e=h("div"),t=h("div"),l=h("img"),a=O(),i=h("h4"),n=ee(c),this.h()},l(g){e=_(g,"DIV",{class:!0});var p=y(e);t=_(p,"DIV",{class:!0});var b=y(t);l=_(b,"IMG",{src:!0,class:!0,alt:!0}),b.forEach(f),a=P(p),i=_(p,"H4",{class:!0});var m=y(i);n=te(m,c),m.forEach(f),p.forEach(f),this.h()},h(){H(l.src,s=r[0].avatar)||o(l,"src",s),o(l,"class","cover svelte-z7uzbe"),o(l,"alt",""),o(t,"class","userimg svelte-z7uzbe"),o(i,"class","svelte-z7uzbe"),o(e,"class","imgText svelte-z7uzbe")},m(g,p){M(g,e,p),u(e,t),u(t,l),u(e,a),u(e,i),u(i,n)},p(g,p){p&1&&!H(l.src,s=g[0].avatar)&&o(l,"src",s),p&1&&c!==(c=g[0].name+"")&&se(n,c)},d(g){g&&f(e)}}}function bt(r){let e=[],t=new Map,l,s=r[1];const a=i=>i[27].createdAt;for(let i=0;i<s.length;i+=1){let c=vt(r,s,i),n=a(c);t.set(n,e[i]=Dt(n,c))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=Z()},l(i){for(let c=0;c<e.length;c+=1)e[c].l(i);l=Z()},m(i,c){for(let n=0;n<e.length;n+=1)e[n].m(i,c);M(i,l,c)},p(i,c){c&3&&(s=i[1],e=Qe(e,c,a,1,i,s,t,l.parentNode,Xe,Dt,l,vt))},d(i){for(let c=0;c<e.length;c+=1)e[c].d(i);i&&f(l)}}}function kt(r){let e,t,l,s,a=r[27].message+"",i,c,n,g=oe(r[27].createdAt.toDate())+"",p,b=r[27].image&&yt(r),m=r[27].audio&&Et(r);return{c(){e=h("div"),t=h("p"),b&&b.c(),l=O(),m&&m.c(),s=O(),i=ee(a),c=O(),n=h("span"),p=ee(g),this.h()},l(v){e=_(v,"DIV",{class:!0});var E=y(e);t=_(E,"P",{style:!0,class:!0});var k=y(t);b&&b.l(k),l=P(k),m&&m.l(k),s=P(k),i=te(k,a),c=P(k),n=_(k,"SPAN",{class:!0});var d=y(n);p=te(d,g),d.forEach(f),k.forEach(f),E.forEach(f),this.h()},h(){o(n,"class","svelte-z7uzbe"),j(t,"display","flex"),j(t,"flex-direction","column"),j(t,"align-items","flex-end"),o(t,"class","svelte-z7uzbe"),o(e,"class","message my_message svelte-z7uzbe")},m(v,E){M(v,e,E),u(e,t),b&&b.m(t,null),u(t,l),m&&m.m(t,null),u(t,s),u(t,i),u(t,c),u(t,n),u(n,p)},p(v,E){v[27].image?b?b.p(v,E):(b=yt(v),b.c(),b.m(t,l)):b&&(b.d(1),b=null),v[27].audio?m?m.p(v,E):(m=Et(v),m.c(),m.m(t,s)):m&&(m.d(1),m=null),E&2&&a!==(a=v[27].message+"")&&se(i,a),E&2&&g!==(g=oe(v[27].createdAt.toDate())+"")&&se(p,g)},d(v){v&&f(e),b&&b.d(),m&&m.d()}}}function yt(r){let e,t,l;return{c(){e=h("img"),this.h()},l(s){e=_(s,"IMG",{src:!0,alt:!0,style:!0,class:!0}),this.h()},h(){H(e.src,t=r[27].image)||o(e,"src",t),o(e,"alt",l=r[27].text),j(e,"margin-bottom","12px"),o(e,"class","svelte-z7uzbe")},m(s,a){M(s,e,a)},p(s,a){a&2&&!H(e.src,t=s[27].image)&&o(e,"src",t),a&2&&l!==(l=s[27].text)&&o(e,"alt",l)},d(s){s&&f(e)}}}function Et(r){let e,t,l,s;return{c(){e=h("audio"),t=h("source"),s=h("track"),this.h()},l(a){e=_(a,"AUDIO",{style:!0,class:!0});var i=y(e);t=_(i,"SOURCE",{src:!0}),s=_(i,"TRACK",{kind:!0}),i.forEach(f),this.h()},h(){H(t.src,l=r[27].audio)||o(t,"src",l),o(s,"kind","captions"),e.controls=!0,j(e,"margin-bottom","12px"),o(e,"class","svelte-z7uzbe")},m(a,i){M(a,e,i),u(e,t),u(e,s)},p(a,i){i&2&&!H(t.src,l=a[27].audio)&&o(t,"src",l)},d(a){a&&f(e)}}}function It(r){let e,t,l,s,a=r[27].message+"",i,c,n,g=oe(r[27].createdAt.toDate())+"",p,b,m=r[27].image&&zt(r),v=r[27].audio&&wt(r);return{c(){e=h("div"),t=h("p"),m&&m.c(),l=O(),v&&v.c(),s=O(),i=ee(a),c=O(),n=h("span"),p=ee(g),b=O(),this.h()},l(E){e=_(E,"DIV",{class:!0});var k=y(e);t=_(k,"P",{style:!0,class:!0});var d=y(t);m&&m.l(d),l=P(d),v&&v.l(d),s=P(d),i=te(d,a),c=P(d),n=_(d,"SPAN",{class:!0});var w=y(n);p=te(w,g),w.forEach(f),d.forEach(f),b=P(k),k.forEach(f),this.h()},h(){o(n,"class","svelte-z7uzbe"),j(t,"display","flex"),j(t,"flex-direction","column"),o(t,"class","svelte-z7uzbe"),o(e,"class","message friend_message svelte-z7uzbe")},m(E,k){M(E,e,k),u(e,t),m&&m.m(t,null),u(t,l),v&&v.m(t,null),u(t,s),u(t,i),u(t,c),u(t,n),u(n,p),u(e,b)},p(E,k){E[27].image?m?m.p(E,k):(m=zt(E),m.c(),m.m(t,l)):m&&(m.d(1),m=null),E[27].audio?v?v.p(E,k):(v=wt(E),v.c(),v.m(t,s)):v&&(v.d(1),v=null),k&2&&a!==(a=E[27].message+"")&&se(i,a),k&2&&g!==(g=oe(E[27].createdAt.toDate())+"")&&se(p,g)},d(E){E&&f(e),m&&m.d(),v&&v.d()}}}function zt(r){let e,t,l;return{c(){e=h("img"),this.h()},l(s){e=_(s,"IMG",{src:!0,alt:!0,style:!0,class:!0}),this.h()},h(){H(e.src,t=r[27].image)||o(e,"src",t),o(e,"alt",l=r[27].text),j(e,"margin-bottom","12px"),o(e,"class","svelte-z7uzbe")},m(s,a){M(s,e,a)},p(s,a){a&2&&!H(e.src,t=s[27].image)&&o(e,"src",t),a&2&&l!==(l=s[27].text)&&o(e,"alt",l)},d(s){s&&f(e)}}}function wt(r){let e,t,l,s;return{c(){e=h("audio"),t=h("source"),s=h("track"),this.h()},l(a){e=_(a,"AUDIO",{style:!0,class:!0});var i=y(e);t=_(i,"SOURCE",{src:!0}),s=_(i,"TRACK",{kind:!0}),i.forEach(f),this.h()},h(){H(t.src,l=r[27].audio)||o(t,"src",l),o(s,"kind","captions"),e.controls=!0,j(e,"margin-bottom","12px"),o(e,"class","svelte-z7uzbe")},m(a,i){M(a,e,i),u(e,t),u(e,s)},p(a,i){i&2&&!H(t.src,l=a[27].audio)&&o(t,"src",l)},d(a){a&&f(e)}}}function Dt(r,e){let t,l,s,a=e[27].from===ne.currentUser.uid&&kt(e),i=e[27].from===e[0].uid&&It(e);return{key:r,first:null,c(){t=Z(),a&&a.c(),l=O(),i&&i.c(),s=Z(),this.h()},l(c){t=Z(),a&&a.l(c),l=P(c),i&&i.l(c),s=Z(),this.h()},h(){this.first=t},m(c,n){M(c,t,n),a&&a.m(c,n),M(c,l,n),i&&i.m(c,n),M(c,s,n)},p(c,n){e=c,e[27].from===ne.currentUser.uid?a?a.p(e,n):(a=kt(e),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null),e[27].from===e[0].uid?i?i.p(e,n):(i=It(e),i.c(),i.m(s.parentNode,s)):i&&(i.d(1),i=null)},d(c){c&&f(t),a&&a.d(c),c&&f(l),i&&i.d(c),c&&f(s)}}}function Vt(r){let e,t=r[2].name+"",l;return{c(){e=h("div"),l=ee(t),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=y(e);l=te(a,t),a.forEach(f),this.h()},h(){o(e,"class","file-name common svelte-z7uzbe")},m(s,a){M(s,e,a),u(e,l)},p(s,a){a&4&&t!==(t=s[2].name+"")&&se(l,t)},d(s){s&&f(e)}}}function jt(r){let e,t;return{c(){e=h("div"),t=ee("Audio is ready"),this.h()},l(l){e=_(l,"DIV",{class:!0});var s=y(e);t=te(s,"Audio is ready"),s.forEach(f),this.h()},h(){o(e,"class","audio-notice common svelte-z7uzbe")},m(l,s){M(l,e,s),u(e,t)},d(l){l&&f(e)}}}function il(r){let e,t,l,s;const a=[al,sl],i=[];function c(n,g){return n[0]?1:0}return e=c(r),t=i[e]=a[e](r),{c(){t.c(),l=Z()},l(n){t.l(n),l=Z()},m(n,g){i[e].m(n,g),M(n,l,g),s=!0},p(n,[g]){let p=e;e=c(n),e===p?i[e].p(n,g):(Ue(),ce(i[p],1,1,()=>{i[p]=null}),Ae(),t=i[e],t?t.p(n,g):(t=i[e]=a[e](n),t.c()),ie(t,1),t.m(l.parentNode,l))},i(n){s||(ie(t),s=!0)},o(n){ce(t),s=!1},d(n){i[e].d(n),n&&f(l)}}}function rl(r,e,t){let l=null,s=null,a=null,i=null,c=null,n=null,g=null,p=!1,b="",m=null,v=!1,E=!1,k=null,d=!1,w=ne.currentUser.uid;const I=$e();Se.subscribe(L=>{t(0,m=L)}),st.subscribe(L=>{t(1,k=L)});const T=async()=>{let L=pe(ue,"whatzapp_users",w);try{await He(L,{isOnline:!1}),await St(ne),console.log("user logged out")}catch(S){console.log(S.message)}},W=async L=>{if(L.charCode===13){if(b===null){alert("Please enter something !");return}t(8,d=!1);try{let S=m.uid,B=b;t(6,b="");let q=w>S?`${w+S}`:`${S+w}`,F=je(ue,"whatzapp_messages",q,"chat");await Lt(F,{message:B,from:w,to:S,createdAt:tt.fromDate(new Date),image:s||"",audio:i||""}),await Rt(pe(ue,"whatzapp_lastMsg",q),{message:B,from:w,to:S,createdAt:tt.fromDate(new Date),image:s||"",audio:i||"",unread:!0}),at.set(q)}catch(S){console.log(S.message)}t(2,l=null),s=null,t(3,i=null)}},N=async L=>{let S=L.target.files[0];if(console.log(S),S&&["image/png","image/jpeg","image/jpg"].includes(S.type)){t(2,l=S),console.log("selected file name: ",l.name);const q=he(_e,`whatzapp/${l.name}`),F=await De(q,l);s=await Ve(he(_e,F.ref.fullPath))}else t(2,l=null)},U=L=>{t(6,b+=L.detail.emoji)},C=()=>{v=!v,console.log("audio state: ",v),v?(t(7,E=!0),navigator.mediaDevices.getUserMedia({audio:!0}).then(L=>{n=L,g=new MediaRecorder(L),g.start(),a=[],g.addEventListener("dataavailable",S=>{a.push(S.data)}),g.addEventListener("stop",async S=>{let B=new Blob(a,{type:"audio/wav"}),q=new File([B],Date.now()+".wav",{type:B.type});console.log("audio url: ",q);const F=he(_e,`whatzapp/${q.name}`),fe=await De(F,q),ve=await Ve(he(_e,fe.ref.fullPath));t(3,i=ve)})})):(t(7,E=!1),n.getTracks().forEach(L=>{L.stop()}))},A=()=>{t(4,c.style.width="0",c),I("showUserList",!0)};window.addEventListener("resize",()=>{window.innerWidth<=575?t(5,p=!0):t(5,p=!1)}),et(()=>{Se.set(null),t(4,c.style.width="100vw",c),console.log("window inner width: ",window.innerWidth),window.innerWidth<=575&&t(5,p=!0)});const z=()=>t(8,d=!d);function D(){b=this.value,t(6,b)}function V(L){Fe[L?"unshift":"push"](()=>{c=L,t(4,c)})}const G=()=>t(8,d=!1);return r.$$.update=()=>{r.$$.dirty&1&&m&&console.log("selected user: ",m),r.$$.dirty&2&&k&&console.log("selected user messages: ",k)},[m,k,l,i,c,p,b,E,d,T,W,N,U,C,A,z,D,V,G]}class cl extends Ee{constructor(e){super();Ie(this,e,rl,il,ze,{})}}function nl(r){let e,t;return{c(){e=h("img"),this.h()},l(l){e=_(l,"IMG",{width:!0,src:!0,alt:!0}),this.h()},h(){o(e,"width","200"),H(e.src,t="loading.gif")||o(e,"src",t),o(e,"alt","spinner gif")},m(l,s){M(l,e,s)},i:re,o:re,d(l){l&&f(e)}}}function ol(r){let e,t,l,s,a;return t=new xt({}),s=new cl({}),{c(){e=h("div"),Me(t.$$.fragment),l=O(),Me(s.$$.fragment),this.h()},l(i){e=_(i,"DIV",{class:!0});var c=y(e);Oe(t.$$.fragment,c),l=P(c),Oe(s.$$.fragment,c),c.forEach(f),this.h()},h(){o(e,"class","container svelte-1thoj6z")},m(i,c){M(i,e,c),Pe(t,e,null),u(e,l),Pe(s,e,null),a=!0},i(i){a||(ie(t.$$.fragment,i),ie(s.$$.fragment,i),a=!0)},o(i){ce(t.$$.fragment,i),ce(s.$$.fragment,i),a=!1},d(i){i&&f(e),Ce(t),Ce(s)}}}function ul(r){let e,t,l,s;const a=[ol,nl],i=[];function c(n,g){return n[0]?0:1}return e=c(r),t=i[e]=a[e](r),{c(){t.c(),l=Z()},l(n){t.l(n),l=Z()},m(n,g){i[e].m(n,g),M(n,l,g),s=!0},p(n,[g]){let p=e;e=c(n),e!==p&&(Ue(),ce(i[p],1,1,()=>{i[p]=null}),Ae(),t=i[e],t||(t=i[e]=a[e](n),t.c()),ie(t,1),t.m(l.parentNode,l))},i(n){s||(ie(t),s=!0)},o(n){ce(t),s=!1},d(n){i[e].d(n),n&&f(l)}}}function fl(r,e,t){let l=!1;return et(()=>{const s=Tt(ne,a=>(a?t(0,l=!0):Gt("/"),s))}),[l]}class ml extends Ee{constructor(e){super();Ie(this,e,fl,ul,ze,{})}}export{ml as default};
